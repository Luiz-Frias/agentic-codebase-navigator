# mise.toml - agentic_codebase_navigator
# Unified version management + env vars
# Docs: https://mise.jdx.dev/

[env]
# Project-specific env vars (loaded automatically when entering directory)
PYTHONDONTWRITEBYTECODE = "1"
PYTHONUNBUFFERED = "1"

# Load secrets from .env
_.file = ".env"

# Auto-activate .venv when entering directory (mise uses uv to create it)
# uv reads Python version from .python-version or pyproject.toml [project.requires-python]
_.python.venv = { path = ".venv", create = true }

[settings.python]
# Use uv for venv creation when uv.lock exists (no mise Python needed)
uv_venv_auto = true

[tools]
# Python version managed by uv (reads .python-version or pyproject.toml)
# mise delegates venv creation to uv when uv is installed
uv = "latest"
just = "latest"
# prek (pre-commit-rs) - fast Rust-based pre-commit runner
"github:j178/prek" = "latest"

[tasks.check]
description = "Run linting and type checks"
run = "just pc-all"

[tasks.test]
description = "Run tests"
run = "uv run pytest"

[tasks.gate]
description = "Full pre-commit + pre-push gate"
run = "just pc-full"

[tasks.sync]
description = "Sync dependencies (dev + test groups)"
run = "uv sync --group dev --group test"

[hooks]
# Auto-sync dev+test dependencies when entering the project directory
enter = "uv sync --group dev --group test --quiet"

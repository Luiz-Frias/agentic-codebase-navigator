# =============================================================================
# .envrc - agentic_codebase_navigator (minimal: mise handles env + tools)
# =============================================================================
# This file now only provides the startup message.
# All env vars and tool versions are managed by mise.toml
# =============================================================================

if [[ -z "${_DIRENV_LOADED}" ]]; then
    # -------------------------------------------------------------------------
    # ADHD-friendly context snapshot: "Where am I? What's available?"
    # -------------------------------------------------------------------------

    # Gather live data
    _proj="agentic_codebase_navigator"
    _branch=$(git branch --show-current 2>/dev/null || echo "???")
    _python=$(.venv/bin/python3 --version 2>/dev/null | awk '{print $2}' || echo "???")
    _uv=$(uv --version 2>/dev/null | awk '{print $2}' || echo "???")
    _just=$(just --version 2>/dev/null | awk '{print $2}' || echo "???")

    # Quick health checks
    _venv="✗"
    [[ -d ".venv" ]] && _venv="✓"
    _env="✗"
    [[ -f ".env" ]] && _env="✓"
    _hooks="✗"
    [[ -f ".git/hooks/pre-commit" ]] && _hooks="✓"

    echo ""
    echo "┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓"
    echo "┃  📍 ${_proj}                                   ┃"
    echo "┣━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┫"
    echo "┃  🌿 branch: ${_branch}"
    echo "┃  🐍 python: ${_python}      📦 uv: ${_uv}"
    echo "┃  📋 just:   ${_just}"
    echo "┣━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┫"
    echo "┃  ${_venv} .venv    ${_env} .env    ${_hooks} git hooks"
    echo "┣━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┫"
    echo "┃  ⚡ just pc-all │ uv run pytest │ just pc-full                   ┃"
    echo "┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛"
    echo ""

    export _DIRENV_LOADED=1
fi
